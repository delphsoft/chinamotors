<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ChinaMotors Compact - Precios Ultra Limpios</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.css" />
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useMemo, useEffect } = React;
    const DOLAR_BLUE = 1415;

    const vehiculos = [
      { id: 1, marca: "BYD", modelo: "Dolphin Mini", precioARS: 32530000, img: "https://i.imgur.com/Q5vR8xL.jpeg", electrico: true },
      { id: 2, marca: "BYD", modelo: "Yuan Pro", precioARS: 40893500, img: "https://i.imgur.com/8vR7pLm.jpeg", electrico: true },
      { id: 3, marca: "Chery", modelo: "Tiggo 4 Pro", precioARS: 41747000, img: "https://i.imgur.com/fG8mP3k.jpeg" },
      { id: 4, marca: "BAIC", modelo: "X35 Plus", precioARS: 36082000, img: "https://i.imgur.com/7jKpL9m.jpeg" },
      { id: 5, marca: "CFMoto", modelo: "800MT-X", precioARS: 18900000, img: "https://i.imgur.com/9vL2mPx.jpeg" },
      { id: 6, marca: "Zontes", modelo: "T350", precioARS: 10500000, img: "https://i.imgur.com/X8pQ3vM.jpeg" },
      ...Array.from({length: 36}, (_, i) => ({
        id: i + 7,
        marca: ["BYD","Chery","BAIC","Haval","CFMoto","QJMotor","Zontes","Jetour","MG","Foton","Benelli","Lifan"][i % 12],
        modelo: ["Dolphin","Tiggo 4","X55","Jolion","450NK","SRT 550","GK 350","X70","ZS EV","Tunland","TRK 502","KPV150"][i % 12],
        precioARS: Math.floor(Math.random() * 50000000) + 15000000,
        img: `https://i.imgur.com/${["Q5vR8xL","fG8mP3k","7jKpL9m","5kLmN2P","X8pQ3vM","rT2vN8y","9vL2mPx"][i % 7]}.jpeg`,
        electrico: i % 6 === 0
      }))
    ];

    const App = () => {
      const [dark, setDark] = useState(false);
      const [favoritos, setFavoritos] = useState(JSON.parse(localStorage.getItem('fav') || '[]'));
      const [comparar, setComparar] = useState([]);
      const [busqueda, setBusqueda] = useState("");
      const [filtroPrecio, setFiltroPrecio] = useState("todos");
      const [filtroTipo, setFiltroTipo] = useState("todos");
      const [filtroMarca, setFiltroMarca] = useState("todos");
      const [showComparador, setShowComparador] = useState(false);

      useEffect(() => {
        document.documentElement.classList.toggle('dark', dark);
        Fancybox.bind("[data-fancybox]");
      }, [dark]);

      const toggleFav = (id) => {
        const newFav = favoritos.includes(id) ? favoritos.filter(f => f !== id) : [...favoritos, id];
        setFavoritos(newFav);
        localStorage.setItem('fav', JSON.stringify(newFav));
      };

      const toggleComparar = (id) => {
        setComparar(prev => prev.includes(id) 
          ? prev.filter(c => c !== id)
          : prev.length < 4 ? [...prev, id] : prev);
      };

      const filtrados = useMemo(() => {
        return vehiculos.filter(v => {
          const matchSearch = v.modelo.toLowerCase().includes(busqueda.toLowerCase()) || v.marca.toLowerCase().includes(busqueda.toLowerCase());
          const matchPrecio = filtroPrecio === "todos" || 
            (filtroPrecio === "barato" && v.precioARS <= 35000000) ||
            (filtroPrecio === "medio" && v.precioARS > 35000000 && v.precioARS <= 60000000) ||
            (filtroPrecio === "premium" && v.precioARS > 60000000);
          const matchTipo = filtroTipo === "todos" || 
            (filtroTipo === "electricos" && v.electrico) ||
            (filtroTipo === "nafta" && !v.electrico);
          const matchMarca = filtroMarca === "todos" || v.marca === filtroMarca;
          return matchSearch && matchPrecio && matchTipo && matchMarca;
        });
      }, [busqueda, filtroPrecio, filtroTipo, filtroMarca]);

      const marcas = [...new Set(vehiculos.map(v => v.marca))].sort();

      const formatoUSD = (ars) => `USD ${(ars / DOLAR_BLUE).toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ".")}`;
      const formatoARS = (ars) => `$${ars.toLocaleString()}`;

      return (
        <div className="min-h-screen">
          {/* Header compacto */}
          <header className="bg-gradient-to-r from-indigo-700 to-purple-800 text-white py-12 text-center">
            <button onClick={() => setDark(!dark)} className="absolute top-4 right-4 bg-white/20 p-2 rounded-full text-sm">Dark Mode</button>
            <h1 className="text-4xl font-bold">ChinaMotors Argentina</h1>
            <p className="text-sm mt-2 opacity-90">42 vehículos • Dólar blue $1.415</p>
          </header>

          {/* Filtros compactos */}
          <div className="bg-white dark:bg-gray-800 shadow-lg sticky top-0 z-50 p-4">
            <div className="max-w-7xl mx-auto grid grid-cols-2 md:grid-cols-4 gap-2 text-sm">
              <input type="text" placeholder="Buscar..." className="px-3 py-2 rounded-lg border text-xs" value={busqueda} onChange={e=>setBusqueda(e.target.value)} />
              <select className="px-3 py-2 rounded-lg border text-xs" onChange={e=>setFiltroPrecio(e.target.value)}>
                <option value="todos">Precio</option>
                <option value="barato">≤35M</option>
                <option value="medio">35-60M</option>
                <option value="premium">≥60M</option>
              </select>
              <select className="px-3 py-2 rounded-lg border text-xs" onChange={e=>setFiltroMarca(e.target.value)}>
                <option value="todos">Marca</option>
                {marcas.map(m => <option key={m} value={m}>{m}</option>)}
              </select>
              <button onClick={()=>setShowComparador(true)} className={`px-3 py-2 rounded-lg font-bold text-xs ${comparar.length ? 'bg-red-600 text-white' : 'bg-gray-300'}`}>
                Comparar ({comparar.length})
              </button>
            </div>
          </div>

          {/* Grid ultra compacto */}
          <div className="max-w-7xl mx-auto p-4">
            <p className="text-xl font-bold text-indigo-700 mb-4">{filtrados.length} resultados</p>
            <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4">
              {filtrados.map(v => (
                <div key={v.id} className="bg-white dark:bg-gray-800 rounded-2xl shadow-md overflow-hidden hover:shadow-xl transition">
                  <a href={v.img} data-fancybox="gallery">
                    <img src={v.img} alt={v.modelo} className="w-full h-40 object-cover" />
                  </a>
                  <div className="p-3">
                    <h3 className="text-sm font-bold line-clamp-1">{v.marca} {v.modelo}</h3>
                    
                    {/* USD grande */}
                    <p className="text-lg font-extrabold text-blue-600 mt-1">
                      {formatoUSD(v.precioARS)}
                    </p>
                    
                    {/* ARS súper pequeño */}
                    <p className="text-xs text-gray-500 dark:text-gray-400">
                      {formatoARS(v.precioARS)}
                    </p>

                    {v.electrico && 
                      <span className="inline-block bg-emerald-100 text-emerald-700 text-xs px-2 py-0.5 rounded mt-1">
                        ELÉCTRICO
                      </span>
                    }

                    <div className="flex gap-1 mt-2">
                      <button 
                        onClick={() => toggleFav(v.id)} 
                        className="flex-1 bg-yellow-500 hover:bg-yellow-600 text-white text-xs py-1.5 rounded transition">
                        {favoritos.includes(v.id) ? 'Favorito' : 'Favorito'}
                      </button>
                      <button 
                        onClick={() => toggleComparar(v.id)} 
                        className={`flex-1 text-xs py-1.5 rounded transition ${comparar.includes(v.id) ? 'bg-red-600 text-white' : 'bg-gray-300 dark:bg-gray-600'}`}>
                        {comparar.includes(v.id) ? 'Comparado' : 'Comparar'}
                      </button>
                    </div>
                  </div>
                </div>
              ))}
            </div>
          </div>

          {/* Comparador */}
          {showComparador && comparar.length > 0 && (
            <div className="fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4">
              <div className="bg-white dark:bg-gray-800 rounded-2xl p-6 max-w-4xl max-h-screen overflow-y-auto">
                <div className="flex justify-between mb-4">
                  <h2 className="text-2xl font-bold">Comparador</h2>
                  <button onClick={() => setShowComparador(false)} className="text-3xl">×</button>
                </div>
                <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                  {comparar.map(id => {
                    const v = vehiculos.find(x => x.id === id);
                    if (!v) return null;
                    return (
                      <div key={id} className="border-2 border-red-600 rounded-xl p-3 text-center">
                        <img src={v.img} className="w-full h-32 object-cover rounded" />
                        <p className="text-xs font-bold mt-2">{v.marca} {v.modelo}</p>
                        <p className="text-sm font-bold text-blue-600">{formatoUSD(v.precioARS)}</p>
                      </div>
                    );
                  })}
                </div>
              </div>
            </div>
          )}

          <footer className="bg-gray-900 text-white text-center py-8 mt-10 text-xs">
            <p>© 2025 ChinaMotors Argentina • Precios noviembre 2025</p>
          </footer>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
